// A de tipo vector<SparseVector>
n = A.size();
for (i = 0; i < n-1; ++i) {
    double mii = A[i].coeff(i);
    for (j = i+1; j < n; ++j) {
        double mij = A[j].coeff(i) / mii;
        if (abs(mij) < epsilon) continue;

        A[j] = (A[j] - A[i] * mij).pruned(1, epsilon);
        b[j] = b[j] - b[i] * mij;
    }
}